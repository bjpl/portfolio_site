{{ define "main" }}
<div class="container">
    <header class="page-header">
        <h1>{{ .Title }}</h1>
        {{ with .Description }}<p class="lead">{{ . }}</p>{{ end }}
    </header>
    
    {{ if .Content }}
    <div class="page-content">
        {{ .Content }}
    </div>
    {{ end }}
    
    <!-- Enhanced Card Grid Layout -->
    <div class="positions-grid">
        {{ $theories := .Pages.ByTitle }}
        {{ $categories := slice }}
        
        <!-- Group theories by category based on content -->
        {{ range $theories }}
            {{ $category := "" }}
            {{ if or (in .Title "Ecological") (in .Title "Dialogic") (in .Title "Mediation") }}
                {{ $category = "foundational" }}
            {{ else if or (in .Title "Identity") (in .Title "Transformational") (in .Title "Person") (in .Title "Motivation") }}
                {{ $category = "identity" }}
            {{ else if or (in .Title "Multi-Competence") (in .Title "Translanguaging") (in .Title "Language Socialization") (in .Title "Intercultural") }}
                {{ $category = "multilingual" }}
            {{ else if or (in .Title "Communities") (in .Title "Collaborative") (in .Title "Institutional") }}
                {{ $category = "social" }}
            {{ else }}
                {{ $category = "critical" }}
            {{ end }}
            
            {{ if eq $category "foundational" }}
                {{ if not (in $categories "foundational-section") }}
                    {{ $categories = $categories | append "foundational-section" }}
                    <section class="position-category">
                        <h3 class="category-title">
                            <span class="category-icon">üå±</span>
                            Foundational Frameworks
                        </h3>
                        <div class="position-cards">
                {{ end }}
                        <article class="position-card">
                            <div class="card-header">
                                <h4><a href="{{ .Permalink }}">{{ .Title }}</a></h4>
                                <span class="card-badge foundational">Core</span>
                            </div>
                            <p class="card-description">{{ .Description | default .Summary }}</p>
                            <div class="card-footer">
                                <a href="{{ .Permalink }}" class="read-more" aria-label="Read more about {{ .Title }}">Explore ‚Üí</a>
                            </div>
                        </article>
            {{ else if eq $category "identity" }}
                {{ if not (in $categories "identity-section") }}
                    {{ if in $categories "foundational-section" }}
                        </div></section>
                    {{ end }}
                    {{ $categories = $categories | append "identity-section" }}
                    <section class="position-category">
                        <h3 class="category-title">
                            <span class="category-icon">üîÑ</span>
                            Identity & Development
                        </h3>
                        <div class="position-cards">
                {{ end }}
                        <article class="position-card">
                            <div class="card-header">
                                <h4><a href="{{ .Permalink }}">{{ .Title }}</a></h4>
                                <span class="card-badge identity">Growth</span>
                            </div>
                            <p class="card-description">{{ .Description | default .Summary }}</p>
                            <div class="card-footer">
                                <a href="{{ .Permalink }}" class="read-more" aria-label="Read more about {{ .Title }}">Explore ‚Üí</a>
                            </div>
                        </article>
            {{ else if eq $category "multilingual" }}
                {{ if not (in $categories "multilingual-section") }}
                    {{ if or (in $categories "foundational-section") (in $categories "identity-section") }}
                        </div></section>
                    {{ end }}
                    {{ $categories = $categories | append "multilingual-section" }}
                    <section class="position-category">
                        <h3 class="category-title">
                            <span class="category-icon">üåç</span>
                            Multilingual Perspectives
                        </h3>
                        <div class="position-cards">
                {{ end }}
                        <article class="position-card">
                            <div class="card-header">
                                <h4><a href="{{ .Permalink }}">{{ .Title }}</a></h4>
                                <span class="card-badge multilingual">Global</span>
                            </div>
                            <p class="card-description">{{ .Description | default .Summary }}</p>
                            <div class="card-footer">
                                <a href="{{ .Permalink }}" class="read-more" aria-label="Read more about {{ .Title }}">Explore ‚Üí</a>
                            </div>
                        </article>
            {{ else if eq $category "social" }}
                {{ if not (in $categories "social-section") }}
                    {{ if or (in $categories "foundational-section") (in $categories "identity-section") (in $categories "multilingual-section") }}
                        </div></section>
                    {{ end }}
                    {{ $categories = $categories | append "social-section" }}
                    <section class="position-category">
                        <h3 class="category-title">
                            <span class="category-icon">üë•</span>
                            Social & Institutional
                        </h3>
                        <div class="position-cards">
                {{ end }}
                        <article class="position-card">
                            <div class="card-header">
                                <h4><a href="{{ .Permalink }}">{{ .Title }}</a></h4>
                                <span class="card-badge social">Community</span>
                            </div>
                            <p class="card-description">{{ .Description | default .Summary }}</p>
                            <div class="card-footer">
                                <a href="{{ .Permalink }}" class="read-more" aria-label="Read more about {{ .Title }}">Explore ‚Üí</a>
                            </div>
                        </article>
            {{ else }}
                {{ if not (in $categories "critical-section") }}
                    {{ if or (in $categories "foundational-section") (in $categories "identity-section") (in $categories "multilingual-section") (in $categories "social-section") }}
                        </div></section>
                    {{ end }}
                    {{ $categories = $categories | append "critical-section" }}
                    <section class="position-category">
                        <h3 class="category-title">
                            <span class="category-icon">üéØ</span>
                            Critical Perspectives
                        </h3>
                        <div class="position-cards">
                {{ end }}
                        <article class="position-card">
                            <div class="card-header">
                                <h4><a href="{{ .Permalink }}">{{ .Title }}</a></h4>
                                <span class="card-badge critical">Analysis</span>
                            </div>
                            <p class="card-description">{{ .Description | default .Summary }}</p>
                            <div class="card-footer">
                                <a href="{{ .Permalink }}" class="read-more" aria-label="Read more about {{ .Title }}">Explore ‚Üí</a>
                            </div>
                        </article>
            {{ end }}
        {{ end }}
        </div>
        </section>
    </div>
</div>

<!-- Enhanced styles for positions layout -->
<link rel="stylesheet" href="/css/sla-positions.css">
{{ end }}