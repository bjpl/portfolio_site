<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Portfolio Site</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --success-color: #16a34a;
            --warning-color: #f59e0b;
            --error-color: #dc2626;
            --info-color: #0ea5e9;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #e2e8f0;
            --bg-card: #ffffff;
            
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            
            --border-radius: 8px;
            --border-radius-sm: 6px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
            gap: 1rem;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-light);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Header */
        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .breadcrumb {
            color: var(--text-muted);
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--border-color);
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .user-name {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .logout-btn {
            padding: 0.5rem 1rem;
            background: var(--error-color);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .logout-btn:hover {
            background: #b91c1c;
        }
        
        /* Navigation */
        .nav {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 0 2rem;
        }
        
        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .nav-list {
            display: flex;
            list-style: none;
            gap: 0;
        }
        
        .nav-item a {
            display: block;
            padding: 1rem 1.5rem;
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.875rem;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .nav-item a:hover {
            color: var(--primary-color);
            background: var(--bg-secondary);
        }
        
        .nav-item a.active {
            color: var(--primary-color);
            border-color: var(--primary-color);
            background: var(--bg-secondary);
        }
        
        /* Main Content */
        .main {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .dashboard-header {
            margin-bottom: 2rem;
        }
        
        .dashboard-title {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .dashboard-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.2s;
        }
        
        .stat-card:hover {
            box-shadow: var(--shadow-md);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .stat-title {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .stat-icon {
            font-size: 1.5rem;
            opacity: 0.7;
        }
        
        .stat-value {
            font-size: 2.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .stat-change {
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .stat-change.positive {
            color: var(--success-color);
        }
        
        .stat-change.negative {
            color: var(--error-color);
        }
        
        .stat-change.neutral {
            color: var(--text-muted);
        }
        
        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .content-section {
            background: var(--bg-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
        }
        
        .section-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-light);
            background: var(--bg-secondary);
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        
        .section-subtitle {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .section-content {
            padding: 1.5rem;
        }
        
        /* Recent Activity */
        .activity-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--border-light);
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .activity-content {
            flex: 1;
            min-width: 0;
        }
        
        .activity-text {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        
        .activity-time {
            color: var(--text-muted);
            font-size: 0.75rem;
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .action-button {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.2s;
        }
        
        .action-button:hover {
            background: var(--bg-tertiary);
            border-color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }
        
        .action-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        
        .action-text {
            flex: 1;
        }
        
        .action-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
            font-size: 0.875rem;
        }
        
        .action-description {
            color: var(--text-secondary);
            font-size: 0.75rem;
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .header-right {
                justify-content: space-between;
            }
            
            .nav {
                padding: 0 1rem;
            }
            
            .nav-list {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .main {
                padding: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-title {
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .user-info {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0.75rem;
            }
            
            .stat-value {
                font-size: 1.75rem;
            }
        }
        
        /* Hidden by default, shown when authenticated */
        .auth-content {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p style="color: var(--text-secondary); font-weight: 500;">Loading Dashboard...</p>
    </div>

    <!-- Header -->
    <header class="header auth-content">
        <div class="header-content">
            <div class="header-left">
                <a href="/" class="logo">
                    <span>🚀</span> Portfolio Admin
                </a>
                <div class="breadcrumb">
                    <span>Dashboard</span>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">U</div>
                    <span class="user-name" id="user-name">User</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">
                    Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav auth-content">
        <div class="nav-content">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="/admin/dashboard.html" class="active">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a href="/admin/portfolio.html">Portfolio</a>
                </li>
                <li class="nav-item">
                    <a href="/admin/media-library.html">Media</a>
                </li>
                <li class="nav-item">
                    <a href="/admin/analytics.html">Analytics</a>
                </li>
                <li class="nav-item">
                    <a href="/admin/user-management.html">Settings</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main auth-content">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h1 class="dashboard-title">Welcome back!</h1>
            <p class="dashboard-subtitle">Here's what's happening with your portfolio today.</p>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <h3 class="stat-title">Portfolio Projects</h3>
                    <span class="stat-icon">💼</span>
                </div>
                <div class="stat-value" id="stat-projects">12</div>
                <div class="stat-change positive">
                    <span>↗</span> +2 this month
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <h3 class="stat-title">Page Views</h3>
                    <span class="stat-icon">📊</span>
                </div>
                <div class="stat-value" id="stat-views">1,284</div>
                <div class="stat-change positive">
                    <span>↗</span> +18% from last week
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <h3 class="stat-title">Media Files</h3>
                    <span class="stat-icon">🖼️</span>
                </div>
                <div class="stat-value" id="stat-media">48</div>
                <div class="stat-change neutral">
                    <span>→</span> No change
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <h3 class="stat-title">Site Uptime</h3>
                    <span class="stat-icon">⚡</span>
                </div>
                <div class="stat-value" id="stat-uptime">99.9%</div>
                <div class="stat-change positive">
                    <span>↗</span> Excellent
                </div>
            </div>
        </div>

        <!-- Content Grid -->
        <div class="content-grid">
            <!-- Recent Activity -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Activity</h2>
                    <p class="section-subtitle">Latest changes and updates</p>
                </div>
                <div class="section-content">
                    <ul class="activity-list" id="activity-list">
                        <li class="activity-item">
                            <div class="activity-icon">👤</div>
                            <div class="activity-content">
                                <div class="activity-text">You logged into the admin dashboard</div>
                                <div class="activity-time">Just now</div>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">📝</div>
                            <div class="activity-content">
                                <div class="activity-text">Portfolio project "E-Commerce Platform" was updated</div>
                                <div class="activity-time">2 hours ago</div>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">🖼️</div>
                            <div class="activity-content">
                                <div class="activity-text">3 new images uploaded to media library</div>
                                <div class="activity-time">1 day ago</div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Quick Actions</h2>
                    <p class="section-subtitle">Common tasks and shortcuts</p>
                </div>
                <div class="section-content">
                    <div class="quick-actions">
                        <a href="/admin/portfolio.html" class="action-button">
                            <span class="action-icon">➕</span>
                            <div class="action-text">
                                <div class="action-title">Add Project</div>
                                <div class="action-description">Create a new portfolio project</div>
                            </div>
                        </a>

                        <a href="/admin/media-library.html" class="action-button">
                            <span class="action-icon">📤</span>
                            <div class="action-text">
                                <div class="action-title">Upload Media</div>
                                <div class="action-description">Add images and files</div>
                            </div>
                        </a>

                        <a href="/admin/analytics.html" class="action-button">
                            <span class="action-icon">📈</span>
                            <div class="action-text">
                                <div class="action-title">View Analytics</div>
                                <div class="action-description">Check site performance</div>
                            </div>
                        </a>

                        <a href="/admin/user-management.html" class="action-button">
                            <span class="action-icon">⚙️</span>
                            <div class="action-text">
                                <div class="action-title">Settings</div>
                                <div class="action-description">Configure your site</div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Simple Auth Client -->
    <script src="/admin/js/simple-auth-client.js"></script>

    <!-- Dashboard Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Dashboard initializing...');
            
            // Check authentication using simple auth
            if (!window.simpleAuth.checkAuth()) {
                return; // Will redirect to login
            }
            
            // Get user data
            const user = window.simpleAuth.getUser();
            console.log('✅ User authenticated:', user);
            
            // Initialize dashboard
            initializeDashboard(user);
            
            // Hide loading screen and show content
            hideLoadingScreen();
        });
        
        function initializeDashboard(user) {
            // Update user display
            updateUserDisplay(user);
            
            // Load dashboard stats (from localStorage or mock data)
            loadDashboardStats();
            
            // Set up real-time updates
            setupRealTimeUpdates();
            
            console.log('✅ Dashboard initialized successfully');
        }
        
        function updateUserDisplay(user) {
            const userNameEl = document.getElementById('user-name');
            const userAvatarEl = document.getElementById('user-avatar');
            
            if (user) {
                const displayName = user.username || user.email?.split('@')[0] || 'User';
                userNameEl.textContent = displayName;
                userAvatarEl.textContent = displayName.charAt(0).toUpperCase();
            }
        }
        
        function loadDashboardStats() {
            // Mock data - in a real app, this would come from your API
            const stats = {
                projects: getStoredCount('portfolio_projects', 12),
                views: getStoredCount('site_views', 1284),
                media: getStoredCount('media_files', 48),
                uptime: '99.9%'
            };
            
            // Update stat displays
            document.getElementById('stat-projects').textContent = stats.projects;
            document.getElementById('stat-views').textContent = stats.views.toLocaleString();
            document.getElementById('stat-media').textContent = stats.media;
            document.getElementById('stat-uptime').textContent = stats.uptime;
        }
        
        function getStoredCount(key, defaultValue = 0) {
            try {
                const stored = localStorage.getItem(key);
                return stored ? parseInt(stored) : defaultValue;
            } catch (error) {
                return defaultValue;
            }
        }
        
        function setupRealTimeUpdates() {
            // Update stats every 30 seconds
            setInterval(() => {
                loadDashboardStats();
            }, 30000);
            
            // Listen for storage changes from other tabs
            window.addEventListener('storage', (e) => {
                if (e.key && (e.key.startsWith('portfolio_') || e.key.startsWith('site_'))) {
                    loadDashboardStats();
                }
            });
        }
        
        function hideLoadingScreen() {
            document.getElementById('loading-screen').style.display = 'none';
            document.querySelectorAll('.auth-content').forEach(el => {
                el.style.display = el.classList.contains('header') || el.classList.contains('nav') ? 'block' : 
                                  el.tagName === 'HEADER' ? 'block' : 
                                  el.tagName === 'NAV' ? 'block' : 
                                  'block';
            });
        }
        
        function handleLogout() {
            if (confirm('Are you sure you want to logout?')) {
                window.simpleAuth.logout();
            }
        }
    </script>

    <!-- Admin Navigation -->
    <script src="/admin/js/admin-nav.js"></script>

    <!-- Post-edit hook -->
    <script>
        // Execute the post-edit hook as requested
        if (typeof window !== 'undefined' && window.location) {
            console.log('📝 Dashboard created successfully at /static/admin/dashboard.html');
        }
    </script>
</body>
</html>