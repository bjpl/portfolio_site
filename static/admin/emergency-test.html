<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® Emergency Login Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
        }
        .container { 
            max-width: 600px; 
            margin: 0 auto; 
            background: rgba(255,255,255,0.1); 
            padding: 30px; 
            border-radius: 15px; 
            backdrop-filter: blur(10px); 
        }
        .credential-box { 
            background: rgba(255,255,255,0.2); 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            border: 1px solid rgba(255,255,255,0.3); 
        }
        .test-btn { 
            background: #28a745; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px; 
        }
        .test-btn:hover { 
            background: #218838; 
        }
        .status { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
        }
        .success { background: rgba(40,167,69,0.3); border: 1px solid #28a745; }
        .error { background: rgba(220,53,69,0.3); border: 1px solid #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® Emergency Client-Side Authentication</h1>
        <p><strong>Status:</strong> <span id="authStatus">Testing...</span></p>
        
        <h2>üìã Available Credentials</h2>
        <div class="credential-box">
            <strong>Admin Access:</strong><br>
            Username: <code>admin</code><br>
            Password: <code>portfolio2024!</code><br>
            <button class="test-btn" onclick="testLogin('admin', 'portfolio2024!')">Test Admin Login</button>
        </div>
        
        <div class="credential-box">
            <strong>Demo Access:</strong><br>
            Username: <code>demo</code><br>
            Password: <code>demo123</code><br>
            <button class="test-btn" onclick="testLogin('demo', 'demo123')">Test Demo Login</button>
        </div>
        
        <div class="credential-box">
            <strong>Guest Access:</strong><br>
            Username: <code>guest</code><br>
            Password: <code>guest123</code><br>
            <button class="test-btn" onclick="testLogin('guest', 'guest123')">Test Guest Login</button>
        </div>
        
        <h2>üîó Quick Access Links</h2>
        <p>
            <a href="login.html" style="color: white; margin-right: 15px;">‚Üí Regular Login Page</a>
            <a href="dashboard.html" style="color: white; margin-right: 15px;">‚Üí Admin Dashboard</a>
            <a href="#" onclick="clearAuth()" style="color: white;">‚Üí Clear Auth & Test</a>
        </p>
        
        <div id="testResults"></div>
        
        <h2>üß™ System Check</h2>
        <button class="test-btn" onclick="runSystemCheck()">Run Full System Check</button>
        <div id="systemCheck"></div>
    </div>

    <script src="client-auth.js"></script>
    <script>
        // Update auth status
        function updateAuthStatus() {
            const status = document.getElementById('authStatus');
            if (window.ClientAuth && ClientAuth.isAuthenticated()) {
                const user = ClientAuth.getCurrentUser();
                status.innerHTML = `‚úÖ Logged in as <strong>${user.username}</strong> (${user.role})`;
                status.className = 'status success';
            } else {
                status.innerHTML = '‚ùå Not authenticated';
                status.className = 'status error';
            }
        }
        
        // Test login function
        function testLogin(username, password) {
            const results = document.getElementById('testResults');
            
            if (!window.ClientAuth) {
                results.innerHTML = '<div class="status error">‚ùå ClientAuth not loaded!</div>';
                return;
            }
            
            const result = ClientAuth.authenticate(username, password);
            
            if (result.success) {
                results.innerHTML = `<div class="status success">‚úÖ Login successful! Token: ${result.token.substring(0, 50)}...</div>`;
                updateAuthStatus();
            } else {
                results.innerHTML = `<div class="status error">‚ùå Login failed: ${result.error}</div>`;
            }
        }
        
        // Clear authentication
        function clearAuth() {
            if (window.ClientAuth) {
                ClientAuth.logout();
                updateAuthStatus();
                document.getElementById('testResults').innerHTML = '<div class="status">üîÑ Authentication cleared</div>';
            }
        }
        
        // Run system check
        function runSystemCheck() {
            const checkDiv = document.getElementById('systemCheck');
            let checks = [];
            
            // Check ClientAuth availability
            checks.push(window.ClientAuth ? '‚úÖ ClientAuth loaded' : '‚ùå ClientAuth missing');
            
            // Check localStorage
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                checks.push('‚úÖ localStorage working');
            } catch (e) {
                checks.push('‚ùå localStorage not available');
            }
            
            // Check if already authenticated
            if (window.ClientAuth) {
                checks.push(ClientAuth.isAuthenticated() ? '‚úÖ Currently authenticated' : 'üî∏ Not authenticated');
                const user = ClientAuth.getCurrentUser();
                if (user) {
                    checks.push(`‚úÖ User info available: ${user.username} (${user.role})`);
                }
            }
            
            checkDiv.innerHTML = '<div class="status">' + checks.join('<br>') + '</div>';
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateAuthStatus();
            runSystemCheck();
        });
    </script>
</body>
</html>